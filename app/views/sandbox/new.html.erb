<section class="oohm-f oohm-0 ">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <h1 class="text-center">Create a new public<span class="orange">ad</span></h1>
      </div>
    </div>
  </div>
</section>


  
<%= form_for(:coohration, url: {controller: "sandbox", action: "get_map"}, html: {multipart: true}, authenticity_token: true) do |f| %>
<section class="oohm-f oohm-0 o-0">
<div class="container">
	<div class="row">
		<div class="col-sm-6">			
			<h1 class="text-center c-w-m instruction-counter" >1</h1>
      <h1 class="text-center instruction-text" >Set marker on public<span class="orange">ad</span> location</h1>

    <div  id="floating-panel">
      <input class="text-center" id="address" type="textbox" placeholder="Street Address">
      <input id="newOoohByAddress" type="button" value="Use Address" class="btn btn-warning m-w-60-p">
    </div>
    
    <h3 class="no-marg text-center" style="padding-bottom:10px;">or</h3>

    <input id="newOoohByCurrentLocation" type="button" value="Use Current Location" class="btn btn-warning d-b c-w-m m-w-60-p">

    <p class="no-marg text-center" style="padding: 10px 10% 0">PS. you can drag the marker to the exact location you want. Feel free to zoom in even more to be as accurate as possible using the Google Maps controls.</p>
		</div>
		<div class="col-sm-6 pad-top-50px">
			<div class="c-w-m " id="map" ></div>
		</div>
	</div>
</div>
</section>
<section class="oohm-f oohm-1 o-0">
<div class="container">
	<div class="row">
		<div class="col-sm-6">		
      <h1 class="text-center c-w-m instruction-counter" >2</h1>	
  		<h1 class="text-center instruction-text">Set Street View as accurately as possible</h1>
      <p class="text-center no-marg instruction-text">You can move marker on map above to make larger position changes and adjust the street view for fine tuning.</p>
      <p class="text-center no-marg instruction-text">If you are happy with your job, move on to the next step.</p>
      <input  id="next_step_1" type="button" value="Next" class="btn btn-warning d-b c-w-m m-w-60-p">
    </div>
    <div class="col-sm-6 ">
      <div id="pani" class="c-w-m"></div>
      <%= f.hidden_field(:pano_id, id: 'pano_id_field')%> 
      <%= f.hidden_field(:heading, id: 'pano_heading')%>
      <%= f.hidden_field(:pitch, id: 'pano_pitch')%> 
      <%= f.hidden_field(:lat, id: 'pano_lat')%>
      <%= f.hidden_field(:lng, id: 'pano_lng')%>
      <%= f.hidden_field(:zoom, id: 'pano_zoom')%>

    </div>
	</div>
</div>
</section>
<section class="oohm-f oohm-2 o-0">
<div class="container">
	<div class="row">
    <div class="col-sm-6">      
      <h1 class="text-center c-w-m instruction-counter" >3</h1> 
      <h1 class="text-center instruction-text">Set public<span class="organge">ad</span> vendor details</h1>
      <%=image_tag('publicad_listing_info.jpg', {class: 'img-responsive center-block listing-img-details visible-xs'} ) %> 
  <div class="form-group">
    <label class="orange text-center d-b c-w-m" > Vendor Name</label>
  <%= f.text_field :oohm_vendor, required: true, class: "w-100p", placeholder: "Example: Clear Channel" %>
  </div>


  <div class="form-group">
    <label class="orange text-center d-b c-w-m" > Listing ID </label>
  <%= f.text_field :oohm_id, required: true, class: "w-100p", placeholder: "Example: 01234-abc" %>
  </div>
      <input id="next_step_2" type="button" value="Next" class="btn btn-warning d-b c-w-m m-w-60-p">
    </div>
    <div class="col-sm-6 hidden-xs">     
      <%=image_tag('publicad_listing_info.jpg', {class: 'img-responsive center-block listing-img-details'} ) %> 
    </div>
	</div>
</div>
</section>
<section class="oohm-f oohm-3 o-0">
<div class="container">
	<div class="row">
    <div class="col-sm-6">      
      <h1 class="text-center c-w-m instruction-counter" >4</h1> 
      <h1 class="text-center instruction-text">Upload picture of public<span class="orange">ad</span></h1>
<div class="form-group">
<%= f.file_field :picture, accept: 'image/png,image/gif,image/jpeg', required:true, class: "d-b c-w-m text-center" %> 
</div>
<div class="form-group">
  <input id="next_step_3" type="button" value="Next" class="pad-top-10px btn btn-warning d-b c-w-m m-w-60-p">
    </div>
    </div>
    <div class="col-sm-6">     
      <img id="image_upload_preview" src="http://placehold.it/300x300" alt="your image" class="img-responsive center-block" />
    </div>
	</div>
</div>
</section>
<section class="oohm-f oohm-4 o-0">
<div class="container">
	<div class="row">
		<div class="col-sm-6 col-sm-offset-3">			
      <h1 class="text-center c-w-m instruction-counter" >5</h1> 
      <h1 class="text-center instruction-text">Review public<span class="orange">ad</span> and submit</h1>
		  <div class="form-group">
        <label class="orange d-b c-w-m text-center" > Public<span class="t-d-g">Ad</span> Type</label>
        <%= f.select :public_ad_category, [ ["Billboard", "Billboard"], ["Bench Ad", "Bench Ad"], ["Bus Stop Ad", "Bus Stop Ad"]], {prompt: "Choose Ad Type"}, {:multiple => false, class: "d-b c-w-m", required: true} %>
        </div>
        <div class="form-group">
          <label class="orange d-b c-w-m text-center" > Title</label>
          <%= f.text_field :title, required: true, class: "w-100p", placeholder: "Example: Nice Billboard" %>
        </div>
        <div class="form-group">
          <label class="orange d-b c-w-m text-center" > Description </label>
          <%= f.text_field :description, required: true, class: "w-100p", placeholder: "Example: On busy cross street in SOMA area" %>
        </div>
        <div class="form-group">
        <%= f.submit "Submit", :class => 'btn btn-warning c-w-m d-b m-w-60-p', id: 'stopy' %>
        </div>
    </div>
	</div>
</div>
</section>
<% end %>




<% content_for :javascripts do %>

<script type="text/javascript">
$('#next_step_1').on('click', function(event){
  $('.oohm-2.o-0').fadeIn('slow');
  $(this).fadeOut('slow');
});
$('#next_step_2').on('click', function(event){
  $('.oohm-3.o-0').fadeIn('slow');
  $(this).fadeOut('slow');
});
$('#next_step_3').on('click', function(event){
  $('.oohm-4.o-0').fadeIn('slow');
  $(this).fadeOut('slow');
});
</script>



<script type="text/javascript">
      function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#image_upload_preview').attr('src', e.target.result);
                $('#image_upload_preview').attr('max-width', '300px');
                $('#image_upload_preview').attr('max-height', '300px');
                $('#image_upload_preview').addClass('img-responsive center-block');
                // $('#image_upload_preview').addClass('img-responsive');
            }

            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#coohration_picture").change(function () {
        readURL(this);
    });
</script>


<script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyD4MNOQPBMHu2SwoXKy0CFvwEP7PcjN-Wg"></script>

 <script>
newOOHM = {};
newOOHM.initMap = function() {
  newOOHM.map = new google.maps.Map(document.getElementById('map'), {
    zoom: 11,
    center: {lat: 37.77516808505975, lng: -122.4378558113159}
  });
  var geocoder = new google.maps.Geocoder();
  var sv = new google.maps.StreetViewService();

  document.getElementById('newOoohByAddress').addEventListener('click', 
    function() {
      newOOHM.geocodeAddress(geocoder, newOOHM.map);
  });
  document.getElementById('newOoohByCurrentLocation').addEventListener('click', function() {
      newOOHM.pickMeUp(newOOHM.map);
  })
};
</script>
<script type="text/javascript">
  newOOHM.streetViewer = function(marker){
    var sv = new google.maps.StreetViewService();
    var coords = marker.getPosition();
    newOOHM.panorama = new google.maps.StreetViewPanorama(
          document.getElementById('pani'), {
            position: coords,
            pov: {heading: 270, pitch: 0},
            zoom: 1
        });
}
</script>
<script type="text/javascript">
newOOHM.geocodeAddress = function (geocoder, resultsMap) {
  var address = document.getElementById('address').value;
  geocoder.geocode({'address': address}, function(results, status) {
    if (status === google.maps.GeocoderStatus.OK) {
      resultsMap.setCenter(results[0].geometry.location);
      if (newOOHM.marker) {
        newOOHM.marker.setMap(null);
      }
      newOOHM.marker = new google.maps.Marker({
        map: resultsMap,
        position: results[0].geometry.location,
        draggable: true,
        animation: google.maps.Animation.DROP
      });
      newOOHM.streetViewer(newOOHM.marker);
      newOOHM.marker.addListener('dragend',function(event) {
          var lati = event.latLng.lat();
          var longi = event.latLng.lng();
      var coords = new google.maps.LatLng(lati, longi)
          newOOHM.panorama.setPosition(coords);
      });
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
  $('.oohm-1.o-0').hide().fadeIn('slow');
}
</script>

<script type="text/javascript">
newOOHM.pickMeUp = function(oohmMap) {
  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;
    var coords = new google.maps.LatLng(latitude, longitude);
      oohmMap.setCenter(coords);
      if (newOOHM.marker) {
        newOOHM.marker.setMap(null);
      }
      newOOHM.marker = new google.maps.Marker({
        map: oohmMap,
        position: coords,
        draggable: true,
        animation: google.maps.Animation.DROP
      });
      newOOHM.streetViewer(newOOHM.marker);
      newOOHM.marker.addListener('dragend',function(event) {
          var lati = event.latLng.lat();
          var longi = event.latLng.lng();
          var coords = new google.maps.LatLng(lati, longi)
          newOOHM.panorama.setPosition(coords);
      });
    $('.oohm-1.o-0').fadeIn('slow');
  }
  function error() {
   alert('there was an error with geolocation. try entering an address.')
  };
  navigator.geolocation.getCurrentPosition(success, error);
}
</script>
<script type="text/javascript">newOOHM.initMap();</script>
<% end %>


<style>
#pano, #pano1{
	width: 350px;
	height: 350px;
}
#hidden_map{
	width: 350px;
	height: 350px;
}

#map {
height: 300px;
width: 300px;
}
#floating-panel {
z-index: 5;
padding: 5px;
text-align: center;
font-family: 'Roboto','sans-serif';
line-height: 30px;
padding-left: 10px;
}

.oohm-f {
	min-height: 400px;
  padding-bottom: 50px;
  padding-top: 50px;
}
.oohm-0{
	background-color: rgba(255,255,255,0.6);
}
.oohm-1{
	background-color: rgba(255,245,238,0.6);
}
.oohm-2{
	background-color: rgba(255,229,180, 0.6);
}
.oohm-3{
	background-color: rgba(255,179,71, 0.6);
}
.oohm-4{
	background-color: rgba(255,168,18, 0.6);
}
#pani{
  width: 300px;
  height: 300px;
}
.oohm-0{
}
.o-0{
  -webkit-transition: all 0.3s ease;transition: all 0.3s ease;
  display: none;
}
.oohm-0.o-0{
  display: block;
}
h1.instruction-counter{
  padding: 5px 0px 7px 0px; width: 40px; border:3px solid black;
}
h1.instruction-text{
  padding:0 10% 15px;
}
.pad-top-50px{
padding-top: 50px;
}
.pad-top-10px{
  margin-top: 100px;
}
p.instruction-text{
  padding: 0 10% 10px;
}
.m-w-60-p{
  width: 60%;
}
@media (min-width: 768px) {
.d-w-60-p{
  width: 60%
} 
}
</style>